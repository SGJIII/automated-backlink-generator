{% extends "base.html" %}

{% block content %}
<h1>Campaign Details: {{ campaign.name }}</h1>

<p>Target URL: {{ campaign.target_url }}</p>
<p>Keyword: {{ campaign.keyword }}</p>
<p>Status: {{ campaign.status }}</p>

<p>Active Sequences: {{ active_sequences_count }}</p>
<p>Total Websites: {{ total_websites_count }}</p>
<p>Successful Outreach: {{ successful_outreach_count }}</p>

<a href="{{ url_for('campaign_websites_page', campaign_id=campaign.id) }}">View Websites</a>
<a href="{{ url_for('campaign_sequences', campaign_id=campaign.id) }}">View Sequences</a>

<form action="{{ url_for('delete_campaign', campaign_id=campaign.id) }}" method="post" onsubmit="return confirm('Are you sure you want to delete this campaign?');">
    <button type="submit">Delete Campaign</button>
</form>

{% if campaign.status == 'active' %}
<form action="{{ url_for('pause_campaign', campaign_id=campaign.id) }}" method="post">
    <button type="submit">Pause Campaign</button>
</form>
{% else %}
<form action="{{ url_for('resume_campaign', campaign_id=campaign.id) }}" method="post">
    <button type="submit">Resume Campaign</button>
</form>
{% endif %}

{% endblock %}

{% block scripts %}
<script>
    document.getElementById('delete-campaign').addEventListener('click', function() {
        if (confirm('Are you sure you want to delete this campaign? This action cannot be undone.')) {
            fetch('{{ url_for("delete_campaign", campaign_id=campaign.id) }}', {
                method: 'POST'
            })
            .then(response => response.json())
            .then(data => {
                if (data.success) {
                    alert('Campaign deleted successfully');
                    window.location.href = '{{ url_for("dashboard") }}';
                } else {
                    alert('Error: ' + data.message);
                }
            });
        }
    });
</script>
{% endblock %}
